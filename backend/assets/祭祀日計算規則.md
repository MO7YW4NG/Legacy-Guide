# 智慧禮儀規劃系統 - 祭祀日計算規則知識庫 (v1.0)

本文件定義了「智慧禮儀規劃助理」系統中，「祭祀日曆產生器」(WP 1.2) 模組所採用的官方計算規則與標準。所有日期相關的計算與輸出，均以此文件為唯一依據。

## 一、總體規則 (General System Rules)

本系統第一版採用以下標準，以確保計算結果的一致性與準確性：

-   **文化背景 (Culture Profile):** 系統第一版**僅支援「閩南」習俗**作為計算基準。所有規則如無特別註明，均指閩南地區的傳統做法。
-   **計算模式 (Schedule Mode):** 系統**同時支援「傳統49天」與「現代24天」**兩種作七計算模式，可根據使用者輸入進行切換。
-   **百日規則 (100-Day Rule):** 固定為歿日後的第一百天，**不採用**任何提前計算的例外。
-   **對年規則 (Anniversary Rule):** 確認採納**「遇閏月提前」**的標準規則。

## 二、作七 (Zuo Qi) 計算模式

### 2.1 傳統49天計算模式 (Traditional 49-Day Mode)

此模式為最完整的傳統作七時程，總計49天。

-   **頭七 (首七):** `歿日 + 6 天` (第7天)
-   **二七:** `歿日 + 13 天` (第14天)
-   **三七:** `歿日 + 20 天` (第21天)
-   **四七:** `歿日 + 27 天` (第28天)
-   **五七:** `歿日 + 34 天` (第35天)
-   **六七:** `歿日 + 41 天` (第42天)
-   **滿七 (尾七):** `歿日 + 48 天` (第49天)

### 2.2 現代24天計算模式 (Modern 24-Day Mode)

此模式為現代社會的彈性方案，將作七儀式集中在約24天內完成。

-   **頭七 (首七):** 計算規則不變，固定為**第7天 (`歿日 + 6 天`)**。
-   **滿七 (尾七):** 固定為**第24天 (`歿日 + 23 天`)**。
-   **二七至六七:** 中間的五個「七」，將在頭七與滿七之間的16天內，**根據龍巖標準化的彈性方案進行計算**。其精確日期需由系統演算法根據預設規則決定（例如，每隔2-3天）。

## 三、重要里程碑日期計算規則

### 3.1 百日 (Bai Ri)

「百日」指亡者往生後的第一百天。

-   **計算規則:** **`歿日 + 99 天`**。
-   **備註:** 本系統採納此唯一計算標準，無任何提前計算的例外情況。

### 3.2 對年 (Dui Nian / Small Xiang)

「對年」指逝世滿一週年，以農曆為計算基準。

-   **基礎規則:** 計算隔年**農曆同月同日**的日期。
-   **閏月特殊規則 (Leap Month Special Rule):**
    -   **觸發條件:** 當「對年」所在的年份有閏月，**且**該閏月的月份**小於或等於**逝者往生的農曆月份時，此規則被觸發。
    -   **執行動作:** 觸發時，「對年」的祭拜月份需**提前一個月**，以確保滿「十二個月」的週期。
    -   **範例1 (觸發):** 逝於去年農曆五月，今年閏三月。因閏月(三月) ≤ 歿月(五月)，故對年日期為今年農曆**四月**。
    -   **範例2 (不觸發):** 逝於去年農曆五月，今年閏七月。因閏月(七月) > 歿月(五月)，故對年日期維持在今年農曆**五月**。

